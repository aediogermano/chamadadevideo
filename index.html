<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Carol — Demo Chamada de Vídeo (DEMO)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap" rel="stylesheet"/>
  <style>
    :root { --glass: rgba(255,255,255,0.04); --accent:#ff6fb1; }
    body { font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, sans-serif; background:#050505; color:#fff; }
    .glass { background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); backdrop-filter: blur(8px); border: 1px solid rgba(255,255,255,0.06); }
    .watermark { pointer-events:none; position:absolute; inset:0; display:grid; place-items:center; color: rgba(255,255,255,0.04); font-weight:800; letter-spacing:.24em; font-size:4.2rem; user-select:none; mix-blend-mode: screen; }
    .video-mirror { transform: scaleX(-1); }
    .typing { border-right: .12em solid rgba(255,255,255,0.3); animation: blink .8s steps(1) infinite; }
    @keyframes blink { 50% { border-color: transparent; } }
    .pulse { animation: pulse 1.6s infinite; }
    @keyframes pulse { 0% { transform:scale(1); opacity:1 } 50% { transform:scale(1.02); opacity:0.9 } 100% { transform:scale(1); opacity:1 } }
    .badge-demo { background: linear-gradient(90deg,#ff4d7a,#ff8fb7); color:#fff; padding:4px 8px; border-radius:999px; font-weight:700; font-size:12px; }
    .muted { color: rgba(255,255,255,0.6); }
    .small { font-size:.85rem; }
  </style>
</head>
<body class="min-h-screen" data-phone="5511999999999">
  <!-- Aviso DEMO (persistente) -->
  <div id="demoNotice" class="fixed top-4 left-1/2 -translate-x-1/2 z-50 glass rounded-full px-4 py-2 flex items-center gap-3 shadow-lg">
    <div class="badge-demo">DEMO</div>
    <div class="small muted">Esta é uma demonstração. Não é uma chamada real. Conteúdo para testes e design somente.</div>
  </div>

  <!-- Modal de Consentimento (claro, não-coercitivo) -->
  <div id="modal" class="fixed inset-0 z-40 flex items-center justify-center bg-black/70 p-6">
    <div class="max-w-xl w-full glass rounded-2xl p-6">
      <h1 class="text-2xl font-bold mb-2">Atenção — Entrada na Demo</h1>
      <p class="text-white/80 mb-4">Este ambiente é uma demonstração de interface para criadores. Ao prosseguir, você aceita que esta chamada é fictícia e utilizada apenas para fins de teste.</p>
      <label class="flex items-start gap-3 mt-2">
        <input id="consent" type="checkbox" class="mt-1 accent-pink-500"/>
        <span class="text-white/80 text-sm">Eu entendi que isto é uma DEMO e concordo em prosseguir.</span>
      </label>
      <div class="mt-5 flex gap-3">
        <button id="enterDemo" class="flex-1 bg-rose-600 hover:bg-rose-500 transition rounded-xl py-3 font-semibold">Entrar na Demo</button>
        <button id="leave" class="px-4 py-3 rounded-xl border border-white/10 hover:bg-white/3 transition">Sair</button>
      </div>
    </div>
  </div>

  <!-- Header -->
  <header class="sticky top-0 z-30 border-b border-white/6 bg-black/60 backdrop-blur">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-xl bg-rose-600 grid place-items-center font-bold">CR</div>
        <div>
          <div class="font-bold">Carol — Demo Ao Vivo</div>
          <div id="status" class="text-xs muted">Status: aguardando</div>
        </div>
      </div>
      <div class="flex items-center gap-3">
        <div class="text-sm muted">Tempo: <span id="timer">00:00</span></div>
        <button id="whatsappCta" class="ml-2 px-3 py-2 rounded-lg" style="background:linear-gradient(90deg,#25D366,#128C7E); color:#fff; font-weight:600;">Falar no WhatsApp</button>
      </div>
    </div>
  </header>

  <!-- Conteúdo -->
  <main class="max-w-6xl mx-auto px-4 py-6 grid md:grid-cols-3 gap-6">
    <section class="md:col-span-2 relative rounded-2xl overflow-hidden glass">
      <div class="absolute inset-0 watermark">CAROL — DEMO</div>

      <!-- Vídeo demo -->
      <video id="remoteVideo" class="w-full aspect-video bg-black object-cover" autoplay muted playsinline loop>
        <source src="https://s3-cf.zapsafe.work/aedio/chamadavideoteste.mp4" type="video/mp4"/>
        Seu navegador não suporta vídeo.
      </video>

      <!-- Controles do vídeo -->
      <div class="absolute bottom-4 left-1/2 -translate-x-1/2">
        <div class="glass rounded-2xl px-4 py-2 flex items-center gap-3">
          <button id="toggleMute" class="px-3 py-2 rounded-lg bg-white/6">Desmutar</button>
          <button id="endCall" class="px-3 py-2 rounded-lg bg-red-600">Encerrar Demo</button>
          <div class="text-sm muted">Demonstração — sem transmissão real</div>
        </div>
      </div>
    </section>

    <aside class="space-y-6">
      <!-- Câmera local -->
      <div class="glass rounded-2xl p-4">
        <div class="flex items-center justify-between mb-3">
          <h2 class="font-bold">Sua câmera (opcional)</h2>
          <span id="camStatus" class="text-xs muted">desligada</span>
        </div>
        <div class="relative rounded-xl overflow-hidden bg-black border border-white/6">
          <video id="localVideo" class="w-full aspect-[4/3] object-cover video-mirror" autoplay muted playsinline></video>
          <div id="localOverlay" class="absolute inset-0 grid place-items-center text-xs muted">Câmera desligada</div>
        </div>
        <div class="mt-3 flex gap-2">
          <button id="startCam" class="flex-1 bg-rose-600 rounded-lg py-2">Ligar câmera</button>
          <button id="stopCam" class="flex-1 bg-white/5 rounded-lg py-2">Desligar</button>
        </div>
      </div>

      <!-- Chat -->
      <div class="glass rounded-2xl overflow-hidden">
        <div class="p-3 border-b border-white/6 font-semibold flex items-center justify-between">
          <div>Chat <span class="badge-demo ml-2">DEMO</span></div>
          <div class="small muted">Mensagens simuladas</div>
        </div>
        <div id="chat" class="h-56 overflow-y-auto p-3 space-y-3 text-sm bg-black/40">
          <div class="text-white/60 text-center text-xs">Bem-vindo à demonstração de chat</div>
        </div>
        <div class="p-3 flex gap-2 border-t border-white/6">
          <input id="chatInput" type="text" placeholder="Digite…" class="flex-1 bg-white/5 border border-white/8 rounded-lg px-3 py-2"/>
          <button id="sendMsg" class="bg-white/10 px-3 py-2 rounded-lg">Enviar</button>
        </div>
      </div>
    </aside>
  </main>

  <footer class="max-w-6xl mx-auto px-4 pb-8 text-white/50 text-xs">
    Esta página é uma DEMONSTRAÇÃO para testes visuais e de interface — uso responsável.
  </footer>

  <script>
    // Configurações
    const fallbackPhone = document.body.getAttribute('data-phone') || "5511999999999";
    const modal = document.getElementById('modal');
    const consent = document.getElementById('consent');

    // Persistir aceitação da demo
    if(localStorage.getItem('demoAccepted') === '1'){
      modal.style.display = 'none';
      startTimer();
      setStatus('Conectado (DEMO)');
    }

    document.getElementById('enterDemo').addEventListener('click', () => {
      if (!consent.checked) { alert('Por favor, confirme que entendeu que isto é uma DEMO.'); return; }
      localStorage.setItem('demoAccepted','1');
      modal.style.display = 'none';
      startTimer();
      setStatus('Conectado (DEMO)');
    });
    document.getElementById('leave').addEventListener('click', () => { window.close(); });

    // Timer & status
    const statusEl = document.getElementById('status');
    const timerEl = document.getElementById('timer');
    let sec = 0, timerId = null;
    function startTimer(){ timerId = setInterval(()=>{ sec++; timerEl.textContent = formatTime(sec); },1000); }
    function formatTime(s){ const m=Math.floor(s/60).toString().padStart(2,'0'); const r=(s%60).toString().padStart(2,'0'); return `${m}:${r}`; }
    function setStatus(t){ statusEl.textContent = 'Status: ' + t; }

    // Remote video controls
    const remoteVideo = document.getElementById('remoteVideo');
    const toggleMute = document.getElementById('toggleMute');
    toggleMute.addEventListener('click', ()=> {
      remoteVideo.muted = !remoteVideo.muted;
      toggleMute.textContent = remoteVideo.muted ? 'Desmutar' : 'Mutar';
    });
    document.getElementById('endCall').addEventListener('click', ()=> {
      if (timerId) clearInterval(timerId);
      setStatus('Demo encerrada');
      remoteVideo.pause();
      alert('Demo encerrada.');
    });

    // WhatsApp CTA
    document.getElementById('whatsappCta').addEventListener('click', ()=> {
      const messages = [
        'Olá, vi a demo e gostaria de mais informações (DEMO).',
        'Gostaria de saber como funciona a versão real; sou criador interessado.',
        'Pergunta sobre API / integrações para criadores — DEMO.'
      ];
      const msg = messages[Math.floor(Math.random()*messages.length)];
      const phoneSanitized = String(fallbackPhone).replace(/\D/g,'');
      const final = phoneSanitized.length ? phoneSanitized : '5511999999999';
      const url = `https://wa.me/${final}?text=${encodeURIComponent(msg)}`;
      window.open(url, '_blank');
    });

    // Webcam local
    const localVideo = document.getElementById('localVideo');
    const localOverlay = document.getElementById('localOverlay');
    const startCam = document.getElementById('startCam');
    const stopCam = document.getElementById('stopCam');
    const camStatus = document.getElementById('camStatus');
    let localStream = null;

    async function enableCam(){
      try {
        localStream = await navigator.mediaDevices.getUserMedia({ video:{ width: 640 }, audio:false });
        localVideo.srcObject = localStream;
        localOverlay.style.display = 'none';
        camStatus.textContent = 'ligada';
      } catch(e){
        alert('Não foi possível acessar a câmera. Verifique permissões.');
      }
    }
    function disableCam(){
      if(localStream){ localStream.getTracks().forEach(t=>t.stop()); localStream=null; }
      localVideo.srcObject = null;
      localOverlay.style.display = 'grid';
      camStatus.textContent = 'desligada';
    }
    startCam.addEventListener('click', enableCam);
    stopCam.addEventListener('click', disableCam);

    // Chat fake com typing effect e timestamps (DEMO)
    const chatBox = document.getElementById('chat');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendMsg');

    function pushMsg(text, me=false, demo=true){
      const wrap = document.createElement('div');
      wrap.className = 'flex ' + (me ? 'justify-end' : 'justify-start');
      const bubble = document.createElement('div');
      bubble.className = 'max-w-[80%] px-3 py-2 rounded-xl text-sm ' + (me ? 'bg-rose-600' : 'bg-white/6');
      // timestamp
      const ts = document.createElement('div');
      ts.className = 'text-[10px] muted mt-1';
      const now = new Date();
      ts.textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) + (demo ? ' • DEMO' : '');
      bubble.textContent = text;
      bubble.appendChild(ts);
      wrap.appendChild(bubble);
      chatBox.appendChild(wrap);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // typing simulation
    async function simulatedTyping(text, delay=40){
      const wrap = document.createElement('div');
      wrap.className = 'flex justify-start';
      const bubble = document.createElement('div');
      bubble.className = 'max-w-[80%] px-3 py-2 rounded-xl text-sm bg-white/6';
      bubble.innerHTML = '<span class="typing">…</span>';
      wrap.appendChild(bubble);
      chatBox.appendChild(wrap);
      chatBox.scrollTop = chatBox.scrollHeight;
      // simulate typing
      await new Promise(res => setTimeout(res, 700 + Math.random()*800));
      bubble.textContent = text;
      const ts = document.createElement('div');
      ts.className = 'text-[10px] muted mt-1';
      const now = new Date();
      ts.textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) + ' • DEMO';
      bubble.appendChild(ts);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // Seed messages (DEMO)
    setTimeout(()=> simulatedTyping('Oi! Bem-vindo à demonstração, posso mostrar algumas funções.'), 1200);
    setTimeout(()=> simulatedTyping('Aqui é só um exemplo de como o chat se comportaria.'), 3200);
    setTimeout(()=> simulatedTyping('Lembre-se: isto é uma demo — sem transmissão real.'), 5600);

    sendBtn.addEventListener('click', ()=>{ const v=chatInput.value.trim(); if(!v) return; pushMsg(v,true,false); chatInput.value=''; setTimeout(()=> simulatedTyping('Resposta automática (DEMO): Mensagem recebida.'),800); });
    chatInput.addEventListener('keydown', e=>{ if(e.key==='Enter') sendBtn.click(); });
  </script>
</body>
</html>
